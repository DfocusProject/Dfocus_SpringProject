<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.skuniv.dfocus_project.mapper.DeptMapper">

    <resultMap id="DeptResultMap" type="com.skuniv.dfocus_project.domain.dept.Dept">
        <result property="deptCode" column="dept_code"/>
        <result property="deptName" column="dept_name"/>
        <result property="parentDept" column="parent_dept"/>
        <result property="deptLeader" column="dept_leader"/>
        <result property="deptCategory" column="dept_category"/>
        <result property="startDate" column="start_date"/>
        <result property="useYn" column="use_yn"/>
        <result property="workPattern" column="work_pattern"/>
    </resultMap>

    <select id="findAll" resultMap="DeptResultMap">
        SELECT
            dept_code,
            dept_name,
            parent_dept,
            dept_leader,
            dept_category,
            start_date,
            use_yn,
            work_pattern
        FROM WEBDEPTINFO
        ORDER BY dept_code
    </select>
    <insert id="insertDept" parameterType="com.skuniv.dfocus_project.domain.dept.Dept">
        INSERT INTO WEBDEPTINFO (
            dept_code,
            dept_name,
            parent_dept,
            dept_category,
            start_date,
            use_yn
        ) VALUES (
                     #{deptCode},
                     #{deptName},
                     #{parentDept},
                     #{deptCategory},
                     #{startDate},
                     #{useYn}
                 )
    </insert>
    <select id="findByDeptCode" parameterType="String" resultMap="DeptResultMap">
        SELECT
            dept_code,
            dept_name,
            parent_dept,
            dept_leader,
            dept_category,
            start_date,
            use_yn,
            work_pattern
        FROM WEBDEPTINFO
        WHERE dept_code = #{deptCode}
    </select>
    <select id="findAllEmpByDeptCode" parameterType="String" resultType="com.skuniv.dfocus_project.dto.EmpDto">
        SELECT
            emp_code AS empCode,
            emp_name AS empName,
            position_code AS positionCode,
            dept_code AS deptCode,
            work_pattern_code AS workPatternCode
        FROM WEBEMPINFO
        WHERE dept_code = #{deptCode}
        ORDER BY emp_name
    </select>
    <update id="updateDeptLeader" parameterType="map">
        UPDATE WEBDEPTINFO
        SET dept_leader = #{emp}
        WHERE dept_code = #{deptCode}
    </update>

</mapper>
